(window.webpackJsonp=window.webpackJsonp||[]).push([[58],{449:function(s,t,a){"use strict";a.r(t);var e=a(9),n=Object(e.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("p",[s._v("之前在做活动的时候，我在腾讯云买了一个轻量应用服务器，正好把这个博客部署到服务器上。")]),s._v(" "),t("h2",{attrs:{id:"_1-在服务器安装环境"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-在服务器安装环境"}},[s._v("#")]),s._v(" 1.在服务器安装环境")]),s._v(" "),t("p",[s._v("我的服务器安装了宝塔Linux面板7.6.0。这个面板比较适合新手。")]),s._v(" "),t("p",[s._v("面板窗口默认为8888，先打开控制台，在防火墙放行面板的端口。")]),s._v(" "),t("p",[s._v("点击左上的添加规则，应用类型为自定义，端口为8888，备注为宝塔面板，其他默认。")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Master-Frank/Image-hosting/img/20211021193246.png",alt:"image-20211021193239338"}})]),s._v(" "),t("p",[s._v("然后打开应用管理的页面，复制左下的命令，再点击登录。")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Master-Frank/Image-hosting/img/20211021193513.png",alt:"image-20211021193513755"}})]),s._v(" "),t("p",[s._v("然后会弹出一个远程登录的窗口。按照下图的指引登录宝塔面板。")]),s._v(" "),t("img",{staticStyle:{zoom:"67%"},attrs:{src:"https://cdn.jsdelivr.net/gh/Master-Frank/Image-hosting/img/20211021193927.png",alt:"image-20211021193927582"}}),s._v(" "),t("p",[s._v("第一次登录宝塔面板会让你选择要按照的环境。这里建议选择左边的LNMP环境，编译安装。安装需要大约半小时。")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Master-Frank/Image-hosting/img/20211021194214.png",alt:"image-20211021194213827"}})]),s._v(" "),t("h2",{attrs:{id:"_2-绑定域名"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-绑定域名"}},[s._v("#")]),s._v(" 2.绑定域名")]),s._v(" "),t("p",[s._v("在等待安装的过程中可以先给服务器绑定域名。再次打开"),t("a",{attrs:{href:"https://console.dnspod.cn/dns/list",target:"_blank",rel:"noopener noreferrer"}},[s._v("域名解析页面"),t("OutboundLink")],1),s._v("，添加一条记录")]),s._v(" "),t("ul",[t("li",[s._v("主机记录：最好和GitHub Pages的不一样")]),s._v(" "),t("li",[s._v("记录类型：A")]),s._v(" "),t("li",[s._v("记录值：你的服务器的公网ip")])]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Master-Frank/Image-hosting/img/20211021200453.png",alt:"image-20211021200453377"}})]),s._v(" "),t("p",[s._v("然后回到宝塔面板，点击左侧的"),t("code",[s._v("网站")]),s._v("，再点击"),t("code",[s._v("添加站点")]),s._v("，按下图指示输入域名信息，然后提交。")]),s._v(" "),t("p",[t("strong",[s._v("记住根目录的路径。")])]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Master-Frank/Image-hosting/img/20211021201715.png",alt:"image-20211021201714921"}})]),s._v(" "),t("p",[s._v("这样域名就绑定完成了。")]),s._v(" "),t("p",[t("strong",[s._v("PS：如果域名没备案，自行去备案一下。")])]),s._v(" "),t("h2",{attrs:{id:"_3-配置nginx"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-配置nginx"}},[s._v("#")]),s._v(" 3.配置Nginx")]),s._v(" "),t("p",[s._v("Nginx应该已经安装成功了。在左侧选择应用商店，在上方选择运行环境，找到Nginx，点击右侧的设置。")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Master-Frank/Image-hosting/img/20211021203342.png",alt:"image-20211021203341804"}})]),s._v(" "),t("p",[s._v("点击左侧的配置修改，找到约在68行的server，修改里面的两处：")]),s._v(" "),t("ul",[t("li",[s._v("listen 80;")]),s._v(" "),t("li",[s._v("root /www/wwwroot/;")])]),s._v(" "),t("img",{staticStyle:{zoom:"67%"},attrs:{src:"https://cdn.jsdelivr.net/gh/Master-Frank/Image-hosting/img/20211021203533.png",alt:"image-20211021203533580"}}),s._v(" "),t("h2",{attrs:{id:"_4-上传网页文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-上传网页文件"}},[s._v("#")]),s._v(" 4.上传网页文件")]),s._v(" "),t("p",[s._v("点击左侧的文件，打开上一步中根目录的路径。")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Master-Frank/Image-hosting/img/20211021202404.png",alt:"image-20211021202404246"}})]),s._v(" "),t("p",[s._v("在本地的博客主目录用Git Bash运行"),t("code",[s._v("npm run build")]),s._v("，等待运行完成，打开"),t("code",[s._v("/docs/.vuepress/dist/")]),s._v("。")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Master-Frank/Image-hosting/img/20211021202543.png",alt:"image-20211021202542931"}})]),s._v(" "),t("p",[s._v("选中该目录的索引文件，拖拽到宝塔面板中，点击开始上传。")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Master-Frank/Image-hosting/img/20211021202842.png",alt:"image-20211021202841836"}})]),s._v(" "),t("p",[s._v("等待上传完成，就可以在刚刚设置的域名访问部署在服务器上的博客啦！")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Master-Frank/Image-hosting/img/20211021203037.png",alt:"image-20211021203036290"}})]),s._v(" "),t("p",[s._v("服务器的访问速度比Github Pages快了不少啊。")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Master-Frank/Image-hosting/img/20211021205435.png",alt:"image-20211021205434943"}})]),s._v(" "),t("h2",{attrs:{id:"_5-使用-webhooks-实现服务器代码自动更新部署"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-使用-webhooks-实现服务器代码自动更新部署"}},[s._v("#")]),s._v(" 5. 使用 Webhooks 实现服务器代码自动更新部署")]),s._v(" "),t("h3",{attrs:{id:"_5-1-准备工作"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-准备工作"}},[s._v("#")]),s._v(" 5.1 准备工作")]),s._v(" "),t("p",[s._v("首先要在服务器上安装 "),t("strong",[s._v("Git")]),s._v("。在控制台找到登录。")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Master-Frank/Image-hosting/img/20211105143938.png",alt:"image-20211105142735564"}})]),s._v(" "),t("p",[s._v("打开后输入"),t("code",[s._v("su root")]),s._v("切换root用户，然后执行下面命令确保已经安装了git，没有安装会自动安装。")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("yum "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Master-Frank/Image-hosting/img/20211105154652.png",alt:"image-20211105154652114"}})]),s._v(" "),t("p",[s._v("然后是生成 ssh key。输入下面的命令。")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1. 首先查看是否配置过密钥")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v(" ~/.ssh\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 2. 如有则跳过此步骤，没有则执行以下命令创建 rsa 密钥对（邮箱换成自己的），然后全程回车使用默认配置即可")]),s._v("\nssh-keygen "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-t")]),s._v(" rsa "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-C")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"xxxxx@xxx.com"')]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 3. 查看公钥内容，然后复制（注意：公钥内容以ssh-rsa开头，邮箱结尾，前后不能有空格）")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" ~/.ssh/id_rsa.pub\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Master-Frank/Image-hosting/img/20211105133533.png",alt:"image-20211105133525872"}})]),s._v(" "),t("p",[s._v("接下来到Github上验证。打开Github，点击右上角的头像，点击settings")]),s._v(" "),t("img",{staticStyle:{zoom:"50%"},attrs:{src:"https://cdn.jsdelivr.net/gh/Master-Frank/Image-hosting/img/20211028102419.png",alt:"image-20211028102419781"}}),s._v(" "),t("p",[s._v("点击左侧的"),t("code",[s._v("SSH and GPG keys")]),s._v("，再点击右上的"),t("code",[s._v("New SSH key")]),s._v("。")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Master-Frank/Image-hosting/img/20211028102543.png",alt:"image-20211028102543746"}})]),s._v(" "),t("p",[s._v("此处要输入两个内容：")]),s._v(" "),t("ul",[t("li",[s._v("title：输入任意一个名字，建议与你当前用的电脑有关")]),s._v(" "),t("li",[s._v("Key：输入刚刚在"),t("code",[s._v("id_rsa.pub")]),s._v("中的内容")])]),s._v(" "),t("p",[s._v("然后点击Add SSH key")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Master-Frank/Image-hosting/img/20211028103050.png",alt:"image-20211028103049913"}})]),s._v(" "),t("p",[s._v("最后还需要输入一次GitHub的密码，SSH验证就成功啦。")]),s._v(" "),t("h3",{attrs:{id:"_5-2-在服务器中设置-webhook"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-在服务器中设置-webhook"}},[s._v("#")]),s._v(" 5.2 在服务器中设置 WebHook")]),s._v(" "),t("p",[s._v("打开宝塔面板的软件商店，安装名为 "),t("code",[s._v("宝塔WebHook")]),s._v(" 的应用。")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Master-Frank/Image-hosting/img/20211105155048.png",alt:"image-20211105155048604"}})]),s._v(" "),t("p",[s._v("安装完后点击设置，添加。名称自定义。执行脚本最好先输入任意一个符号，在编辑的时候重新添加shell命令进去，因为在此处的编辑框输入的命令会被过滤。")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Master-Frank/Image-hosting/img/20211105155357.png",alt:"image-20211105155357633"}})]),s._v(" "),t("p",[s._v("创建好后点击编辑。")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Master-Frank/Image-hosting/img/20211105155807.png",alt:"image-20211105155807688"}})]),s._v(" "),t("p",[s._v("输入下方的命令。")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token shebang important"}},[s._v("#!/bin/bash")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 输出当前时间")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("date")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--date")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'0 days ago'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"+%Y-%m-%d %H:%M:%S"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Start"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 判断宝塔WebHook参数是否存在")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-n")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$1")]),s._v('"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v(" \n          "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"param参数错误"')]),s._v("\n          "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"End"')]),s._v("\n          "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fi")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# git项目路径")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("gitPath")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/www/wwwroot/'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$1")]),s._v('"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# git 网址")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("gitHttp")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"https://gitee.com/frank-starbuck/Frank-Notes.git"')]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Web站点路径：'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$gitPath")]),s._v('"')]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 判断项目路径是否存在")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$gitPath")]),s._v('"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$gitPath")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-rf")]),s._v(" *\n        "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" clone "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-b")]),s._v(" gh-pages "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$gitHttp")]),s._v(" gittemp\n        "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mv")]),s._v(" gittemp/* "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-rf")]),s._v(" gittemp\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fi")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置目录权限")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("chown")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-R")]),s._v(" www:www "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$gitPath")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"End"')]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"该项目路径不存在"')]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"End"')]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fi")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br")])]),t("p",[s._v("添加完成后，点击查看密钥。")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Master-Frank/Image-hosting/img/20211107112327.png",alt:"image-20211107112213581"}})]),s._v(" "),t("p",[s._v("组成的链接是这样的：http://面板Ip加端口/hook?access_key=密钥&param=项目在/www/wwwroot/目录下的目录")]),s._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[s._v("提示")]),s._v(" "),t("p",[s._v("说明：当前shell命令把目录作为了变量 param 传输是考虑了多项目的情况。")])]),s._v(" "),t("p",[s._v("复制该链接，拼接好参数备用。")]),s._v(" "),t("h3",{attrs:{id:"_5-3-在gitte中配置webhook"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-3-在gitte中配置webhook"}},[s._v("#")]),s._v(" 5.3 在Gitte中配置WebHook")]),s._v(" "),t("p",[s._v("我原先打算在Github中使用 WebHook ，但经过测试发现了两个问题：")]),s._v(" "),t("ul",[t("li",[s._v("git clone的"),t("strong",[s._v("失败率非常高")]),s._v("，会导致网页无法访问403。")]),s._v(" "),t("li",[s._v("WebHook的触发条件是push。push后同时执行Github Action的自动部署和WebHook，此时最新的网页文件还没生成，服务器拉取到的网页文件是上一次更新的网页文件。而当网页文件同步到Gitte的gh-pages分支时触发WebHook，服务器就能获取到最新的网页文件。")])]),s._v(" "),t("p",[s._v("为了解决这个问题，我尝试"),t("RouterLink",{attrs:{to:"/pages/432630/"}},[s._v("通过Github Actions把代码自动同步到Gitte")]),s._v("，然后让服务器从Gitte中拉取网页文件。")],1),s._v(" "),t("h4",{attrs:{id:"_5-3-1-获取gitte的私人令牌"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-3-1-获取gitte的私人令牌"}},[s._v("#")]),s._v(" 5.3.1 获取Gitte的私人令牌")]),s._v(" "),t("p",[s._v("打开Gitte，登录后点击右上角的头像，点击设置。")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Master-Frank/Image-hosting/img/20211105232119.png",alt:"image-20211105232119356"}})]),s._v(" "),t("p",[s._v("选择左侧的私人令牌，点击生成新令牌。")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Master-Frank/Image-hosting/img/20211105232531.png",alt:"image-20211105232531624"}})]),s._v(" "),t("p",[s._v("任意填写一个描述，点击提交。")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Master-Frank/Image-hosting/img/20211105232630.png",alt:"image-20211105232630312"}})]),s._v(" "),t("p",[s._v("提交后会生成一个私人令牌，"),t("strong",[s._v("只显示一次")]),s._v("，"),t("strong",[s._v("一定要注意保存")]),s._v("！")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Master-Frank/Image-hosting/img/20211105233033.png",alt:"image-20211105233033578"}})]),s._v(" "),t("h4",{attrs:{id:"_5-3-2-在github中添加actions-secret"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-3-2-在github中添加actions-secret"}},[s._v("#")]),s._v(" 5.3.2 在Github中添加Actions Secret")]),s._v(" "),t("p",[s._v("在Github的仓库中打开"),t("code",[s._v("Settings")]),s._v("，选择左边的"),t("code",[s._v("Secrets")]),s._v("，点击右上的"),t("code",[s._v("New repository secret")]),s._v("。")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Master-Frank/Image-hosting/img/20211104235459.png",alt:"image-20211104235452374"}})]),s._v(" "),t("p",[s._v("在Name输入"),t("code",[s._v("GITEE_TOKEN")]),s._v("（一定要一样），Value中填上一步在Gitte中生成的私人令牌，点击"),t("code",[s._v("Add secret")]),s._v("。")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Master-Frank/Image-hosting/img/20211106135934.png",alt:"image-20211106135926959"}})]),s._v(" "),t("p",[s._v("找到本地生成的ssh key（"),t("RouterLink",{attrs:{to:"/06.关于/f2c999/#_6-2-ssh验证"}},[s._v("教程点这里")]),s._v("）中有两个文件， 其中 "),t("code",[s._v("id_rsa")]),s._v(" 是私钥，"),t("code",[s._v("id_rsa.pub")]),s._v(" 是公钥。用记事本打开 "),t("code",[s._v("id_rsa")]),s._v(" ，复制全部内容。")],1),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Master-Frank/Image-hosting/img/20211106000517.png",alt:"image-20211106000517016"}})]),s._v(" "),t("p",[s._v("再添加一个Secret。在Name输入"),t("code",[s._v("GITEE_RSA_PRIVATE_KEY")]),s._v("（一定要一样），Value中填上一步在"),t("code",[s._v("id_rsa")]),s._v("复制的私钥，点击"),t("code",[s._v("Add secret")]),s._v("。")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Master-Frank/Image-hosting/img/20211106001420.png",alt:"image-20211106001420300"}})]),s._v(" "),t("p",[s._v("最后检查一下，一共有三个Secret。")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Master-Frank/Image-hosting/img/20211107012429.png",alt:"image-20211107012422144"}})]),s._v(" "),t("h4",{attrs:{id:"_5-3-3-在gitte中配置webhook"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-3-3-在gitte中配置webhook"}},[s._v("#")]),s._v(" 5.3.3 在Gitte中配置WebHook")]),s._v(" "),t("p",[s._v("打开Gitte的对应仓库，点击管理-WebHooks-添加webHook。")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Master-Frank/Image-hosting/img/20211107090353.png",alt:"image-20211107090346683"}})]),s._v(" "),t("p",[s._v("在URL处输入步骤5.2中组合成的链接，密码输入步骤5.2中生成的密钥，点击添加。")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Master-Frank/Image-hosting/img/20211107090702.png",alt:"image-20211107090702117"}})]),s._v(" "),t("p",[s._v("添加完成，可以点击测试。")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Master-Frank/Image-hosting/img/20211107091250.png",alt:"image-20211107091250072"}})]),s._v(" "),t("p",[s._v("在宝塔WebHook的日志中可以看到，已经执行成功了。")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Master-Frank/Image-hosting/img/20211107091344.png",alt:"image-20211107091344608"}})]),s._v(" "),t("p",[s._v("网页文件也成功被更新。")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Master-Frank/Image-hosting/img/20211107091547.png",alt:"image-20211107091546969"}})]),s._v(" "),t("p",[s._v("到这里，自动部署到服务器的教程就结束啦！全国一片绿色，我好起来了！")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Master-Frank/Image-hosting/img/20211107150721.png",alt:"image-20211107150721632"}})]),s._v(" "),t("Vssue")],1)}),[],!1,null,null,null);t.default=n.exports}}]);