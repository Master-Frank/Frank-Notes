(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{424:function(t,s,a){"use strict";a.r(s);var n=a(9),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"利用github-action实现github到gitee的持续同步"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#利用github-action实现github到gitee的持续同步"}},[t._v("#")]),t._v(" 利用Github Action实现Github到Gitee的持续同步")]),t._v(" "),s("p",[t._v("[TOC]")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Master-Frank/Image-hosting/img/20211107093551.png",alt:"image-20211107093551500"}})]),t._v(" "),s("h2",{attrs:{id:"_1、什么是github-action"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1、什么是github-action"}},[t._v("#")]),t._v(" 1、什么是Github Action")]),t._v(" "),s("p",[s("code",[t._v("github action")]),t._v("是"),s("code",[t._v("github")]),t._v("推出的自动化"),s("code",[t._v("CI/CD")]),t._v("的功能，随着"),s("code",[t._v("2019")]),t._v("年"),s("code",[t._v("11")]),t._v("月后"),s("code",[t._v("github")]),t._v("对该功能的全面开放，现在所有的"),s("code",[t._v("github")]),t._v("用户可以直接使用该功能")]),t._v(" "),s("p",[s("code",[t._v("github action")]),t._v("的语法类似于"),s("code",[t._v("gitlab ci")]),t._v("，与之相比，还有更多优势，例如：")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("action")]),t._v("对"),s("code",[t._v("github")]),t._v("各个事件的支持更为全面，如"),s("code",[t._v("release")]),t._v("、"),s("code",[t._v("pull-request")]),t._v("、"),s("code",[t._v("issue")]),t._v("事件等等")]),t._v(" "),s("li",[s("code",[t._v("action")]),t._v("支持直接使用别人编写好的"),s("code",[t._v("action")])]),t._v(" "),s("li",[s("code",[t._v("action")]),t._v("的执行器类似于"),s("code",[t._v("gitlab runner")]),t._v("，可以使用"),s("code",[t._v("github")]),t._v("托管的执行器，也可以托管自己的执行器。甚至在"),s("code",[t._v("action")]),t._v("运行的时候，还可以通过某些特殊技巧进入到执行器里面，相当于一台临时的服务器供我们使用")])]),t._v(" "),s("h2",{attrs:{id:"_2、github和gitee同步"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2、github和gitee同步"}},[t._v("#")]),t._v(" 2、github和gitee同步")]),t._v(" "),s("p",[s("code",[t._v("github")]),t._v("的服务器在国外，因为某些原因，在大多数的网络环境下都是无法顺畅访问的")]),t._v(" "),s("p",[s("code",[t._v("gitee")]),t._v("的服务器在国内，由国内公司运营")]),t._v(" "),s("p",[t._v("纵使如此，大多数开发者还是习惯使用"),s("code",[t._v("github")]),t._v("（远在海外，也要想尽各种办法）")]),t._v(" "),s("p",[t._v("那么为什么需要把"),s("code",[t._v("github")]),t._v("和"),s("code",[t._v("gitee")]),t._v("的仓库进行同步呢？原因不言而喻")]),t._v(" "),s("p",[t._v("目前可用的进行同步的方法可能有：")]),t._v(" "),s("ul",[s("li",[t._v("利用"),s("code",[t._v("gitee")]),t._v("官方的同步（导入"),s("code",[t._v("github")]),t._v("项目），这种方法只能一次性导入")]),t._v(" "),s("li",[t._v("本地同时关联"),s("code",[t._v("gitee")]),t._v("和"),s("code",[t._v("github")]),t._v("，提交时都"),s("code",[t._v("push")]),t._v("一份，这种方法纯属手动")]),t._v(" "),s("li",[t._v("利用"),s("code",[t._v("github action")])])]),t._v(" "),s("p",[t._v("下面介绍利用"),s("code",[t._v("github action")]),t._v("如何实现"),s("code",[t._v("github")]),t._v("到"),s("code",[t._v("gitee")]),t._v("的持续同步")]),t._v(" "),s("h2",{attrs:{id:"_3、选用或编写action"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3、选用或编写action"}},[t._v("#")]),t._v(" 3、选用或编写action")]),t._v(" "),s("p",[t._v("实现"),s("code",[t._v("github")]),t._v("和"),s("code",[t._v("gitee")]),t._v("同步的思路主要是基于我们的账户调用"),s("code",[t._v("github")]),t._v("和"),s("code",[t._v("gitee")]),t._v("各自的"),s("code",[t._v("api")]),t._v("接口和密钥通信，在执行器内拉取并推送代码库到"),s("code",[t._v("gitee")])]),t._v(" "),s("p",[s("code",[t._v("action")]),t._v("的编写语法和"),s("code",[t._v("gitlab ci")]),t._v("很相似，同时"),s("code",[t._v("github")]),t._v("还推出了官方的"),s("code",[t._v("action")]),t._v("市场，地址为 https://github.com/marketplace")]),t._v(" "),s("p",[t._v("这里我们使用的"),s("code",[t._v("action")]),t._v("是"),s("a",{attrs:{href:"https://github.com/Yikun/hub-mirror-action",target:"_blank",rel:"noopener noreferrer"}},[t._v("Yikun/hub-mirror-action"),s("OutboundLink")],1)]),t._v(" "),s("h2",{attrs:{id:"_4、语法示例"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4、语法示例"}},[t._v("#")]),t._v(" 4、语法示例")]),t._v(" "),s("p",[t._v("上述"),s("code",[t._v("action")]),t._v("，支持较为全面。参照说明，相关不同场景下的语法如下：")]),t._v(" "),s("ul",[s("li",[t._v("组织同步")])]),t._v(" "),s("p",[t._v("同步"),s("code",[t._v("Github")]),t._v("的组织到"),s("code",[t._v("Gitee")])]),t._v(" "),s("div",{staticClass:"language-yaml line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Organization mirror\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("uses")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Yikun/hub"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("mirror"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("action@master\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("with")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("src")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" github/kunpengcompute\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("dst")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" gitee/kunpengcompute\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("dst_key")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" secrets.GITEE_PRIVATE_KEY "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("dst_token")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" secrets.GITEE_TOKEN "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("account_type")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" org\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br")])]),s("ul",[s("li",[t._v("黑/白名单")])]),t._v(" "),s("p",[t._v("动态获取源端"),s("code",[t._v("github")]),t._v("的"),s("code",[t._v("repos")]),t._v("，但仅同步名为"),s("code",[t._v("hub-mirror-action")]),t._v("，不同步"),s("code",[t._v("hashes")]),t._v("这个"),s("code",[t._v("repo")]),t._v("到"),s("code",[t._v("Gittee")])]),t._v(" "),s("div",{staticClass:"language-yaml line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Single repo mirror\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("uses")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Yikun/hub"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("mirror"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("action@master\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("with")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("src")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" github/Yikun\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("dst")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" gitee/yikunkero\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("dst_key")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" secrets.GITEE_PRIVATE_KEY "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("dst_token")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" secrets.GITEE_TOKEN "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("white_list")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"hub-mirror-action"')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("black_list")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"hashes"')]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br")])]),s("ul",[s("li",[t._v("静态名单（可用于单一仓库同步）")])]),t._v(" "),s("p",[t._v("不会动态获取源端"),s("code",[t._v("github")]),t._v("的"),s("code",[t._v("repos")]),t._v("，仅同步"),s("code",[t._v("hub-mirror-action")]),t._v("这个"),s("code",[t._v("repo")])]),t._v(" "),s("div",{staticClass:"language-yaml line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Black list\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("uses")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Yikun/hub"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("mirror"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("action@master\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("with")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("src")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" github/Yikun\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("dst")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" gitee/yikunkero\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("dst_key")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" secrets.GITEE_PRIVATE_KEY "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("dst_token")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" secrets.GITEE_TOKEN "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("static_list")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"hub-mirror-action"')]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br")])]),s("ul",[s("li",[t._v("使用ssh方式进行clone")])]),t._v(" "),s("div",{staticClass:"language-yaml line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" ssh clone style\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("uses")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Yikun/hub"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("mirror"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("action@master\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("with")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("src")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" github/Yikun\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("dst")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" gitee/yikunkero\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("dst_key")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" secrets.GITEE_PRIVATE_KEY "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("dst_token")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" secrets.GITEE_TOKEN "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("clone_style")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ssh"')]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br")])]),s("ul",[s("li",[t._v("强制更新，并打开debug日志开关")])]),t._v(" "),s("div",{staticClass:"language-yaml line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Mirror with force push (git push "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("f)\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("uses")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Yikun/hub"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("mirror"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("action@master\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("with")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("src")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" github/Yikun\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("dst")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" gitee/yikunkero\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("dst_key")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" secrets.GITEE_PRIVATE_KEY "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("dst_token")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" secrets.GITEE_TOKEN "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("force_update")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("true")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("debug")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("true")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br")])]),s("ul",[s("li",[t._v("设置命令行超时时间为1小时")])]),t._v(" "),s("div",{staticClass:"language-yaml line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Mirror with force push (git push "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("f)\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("uses")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Yikun/hub"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("mirror"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("action@master\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("with")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("src")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" github/Yikun\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("dst")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" gitee/yikunkero\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("dst_key")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" secrets.GITEE_PRIVATE_KEY "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("dst_token")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" secrets.GITEE_TOKEN "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("force_update")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("true")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("timeout")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'1h'")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br")])]),s("h2",{attrs:{id:"_5、准备工作"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5、准备工作"}},[t._v("#")]),t._v(" 5、准备工作")]),t._v(" "),s("h3",{attrs:{id:"_5-1-设置dst-key"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-设置dst-key"}},[t._v("#")]),t._v(" 5.1 设置dst_key")]),t._v(" "),s("p",[t._v("在"),s("code",[t._v("github")]),t._v("上打开一个自己的仓库（可以是一个已有的仓库，也可以是用来专门存放"),s("code",[t._v("action")]),t._v("的仓库），这里以我的个人公开仓库为例")]),t._v(" "),s("p",[t._v("首先在本地生成一个"),s("code",[t._v("ssh")]),t._v("密钥对")]),t._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ssh-keygen -t rsa -f ~/Documents/ssh-key/id_rsa")]),t._v("\nGenerating public/private rsa key pair.\nEnter passphrase "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("empty "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" no passphrase"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(":\nEnter same passphrase again:\nYour identification has been saved "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" /Users/ssgeek/Documents/Document/ssh-key/id_rsa.\nYour public key has been saved "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" /Users/ssgeek/Documents/Document/ssh-key/id_rsa.pub.\nThe key fingerprint is:\nSHA256:eUf8KzgFFoTikDoo1at9/fVpftcUWkWgTgPNbWTVOdM ssgeek@honganrongdeMac-mini.local\nThe key's randomart image is:\n+---"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("RSA "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3072")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("----+\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("   "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v("   o+o o++*"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v(" + "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v("  +ooo+E"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" o "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v(" + "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v("  o *.  +"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("o o "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v("  o "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" o o "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v("  +   .S "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v(" + + "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(" +"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("     "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v("   .o"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v("o."),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("          "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(" .+ +"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("             o"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v("."),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n+----"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("SHA256"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("-----+\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br"),s("span",{staticClass:"line-number"},[t._v("19")]),s("br"),s("span",{staticClass:"line-number"},[t._v("20")]),s("br")])]),s("p",[t._v("在"),s("code",[t._v("github")]),t._v("打开"),s("code",[t._v("settings")]),t._v("—>"),s("code",[t._v("secrets")]),t._v("，新建一个"),s("code",[t._v("secret")]),t._v("，名为"),s("code",[t._v("GITEE_PRIVATE_KEY")]),t._v("，值为上面生成的密钥对的私钥")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Master-Frank/Image-hosting/img/20211107093646.png",alt:"image-20211107093645974"}})]),t._v(" "),s("p",[t._v("然后登录到"),s("code",[t._v("gitee")]),t._v("，在个人设置—>安全设置—>"),s("code",[t._v("SSH")]),t._v("公钥中添加上面生成的密钥对的公钥，命名随意")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Master-Frank/Image-hosting/img/20211107093708.png",alt:"image-20211107093708327"}})]),t._v(" "),s("h3",{attrs:{id:"_5-2-设置dst-token"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-设置dst-token"}},[t._v("#")]),t._v(" 5.2 设置dst_token")]),t._v(" "),s("p",[t._v("在"),s("code",[t._v("gitee")]),t._v("打开个人设置—>安全设置—>私人令牌，新建一个私人令牌，命名随意，复制生成的令牌值")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Master-Frank/Image-hosting/img/20211107093732.png",alt:"image-20211107093732514"}})]),t._v(" "),s("p",[t._v("在"),s("code",[t._v("github")]),t._v("打开"),s("code",[t._v("settings")]),t._v("—>"),s("code",[t._v("secrets")]),t._v("，新建一个"),s("code",[t._v("secret")]),t._v("，名为"),s("code",[t._v("GITEE_TOKEN")]),t._v("，值为上面复制的令牌值")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Master-Frank/Image-hosting/img/20211107093758.png",alt:"image-20211107093758463"}})]),t._v(" "),s("h2",{attrs:{id:"_6、github同步到gitee"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6、github同步到gitee"}},[t._v("#")]),t._v(" 6、github同步到gitee")]),t._v(" "),s("p",[t._v("在刚才的"),s("code",[t._v("GitHub")]),t._v("仓库中，新建 "),s("code",[t._v(".github/workflows/SyncToGitee.yml")]),t._v(" 文件，其中"),s("code",[t._v(".github/workflows/")]),t._v("是固定的目录名")]),t._v(" "),s("p",[t._v("内容如下")]),t._v(" "),s("div",{staticClass:"language-yaml line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Sync Github Repos To Gitee\n\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("push")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("branches")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" \n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" master\n\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("jobs")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("build")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("runs-on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" ubuntu"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("20.04")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("steps")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Sync Github Repos To Gitee  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 名字随便起")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("uses")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Yikun/hub"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("mirror"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("action@v1.1  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 使用Yikun/hub-mirror-action")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("with")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("src")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" github/Hargeek  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 源端账户名(github)")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("dst")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" gitee/ssgeek  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 目的端账户名(gitee)")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("dst_key")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" secrets.GITEE_PRIVATE_KEY "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# SSH密钥对中的私钥")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("dst_token")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("  $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" secrets.GITEE_TOKEN "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Gitee账户的私人令牌")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("account_type")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" user  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 账户类型")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("clone_style")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https"')]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 使用https方式进行clone，也可以使用ssh")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("debug")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("true")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 启用后会显示所有执行命令")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("force_update")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("true")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 启用后，强制同步，即强制覆盖目的端仓库")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("static_list")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"python-nianbao-struct"')]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 静态同步列表，在此填写需要同步的仓库名称，可填写多个")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("timeout")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'600s'")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# git超时设置，超时后会自动重试git操作")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br"),s("span",{staticClass:"line-number"},[t._v("19")]),s("br"),s("span",{staticClass:"line-number"},[t._v("20")]),s("br"),s("span",{staticClass:"line-number"},[t._v("21")]),s("br"),s("span",{staticClass:"line-number"},[t._v("22")]),s("br"),s("span",{staticClass:"line-number"},[t._v("23")]),s("br"),s("span",{staticClass:"line-number"},[t._v("24")]),s("br"),s("span",{staticClass:"line-number"},[t._v("25")]),s("br")])]),s("p",[t._v("相关语法说明：")]),t._v(" "),s("ul",[s("li",[t._v("on")])]),t._v(" "),s("p",[t._v("指定"),s("code",[t._v("action")]),t._v("的触发条件，一般有：使用web事件触发工作流，并且可以具体指定"),s("code",[t._v("branches")]),t._v("，"),s("code",[t._v("tags")]),t._v("以及文件路径；使用"),s("code",[t._v("cron")]),t._v("语法指定时间触发工作流")]),t._v(" "),s("ul",[s("li",[t._v("job")])]),t._v(" "),s("p",[t._v("指定相应的任务，每一个"),s("code",[t._v("step")]),t._v("是一个步骤，"),s("code",[t._v("step")]),t._v("是"),s("code",[t._v("job")]),t._v("的最小单元，所有"),s("code",[t._v("step")]),t._v("配置在"),s("code",[t._v("steps")]),t._v("中")]),t._v(" "),s("p",[t._v("其中"),s("code",[t._v("uses")]),t._v("用于使用其他用户所发布的"),s("code",[t._v("action")])]),t._v(" "),s("p",[t._v("其他的内容这里不再赘述，更多内容可以参考官方语法说明 "),s("a",{attrs:{href:"https://docs.github.com/cn/actions",target:"_blank",rel:"noopener noreferrer"}},[t._v("github action doc"),s("OutboundLink")],1)]),t._v(" "),s("p",[t._v("提交该"),s("code",[t._v("action")]),t._v("，观察"),s("code",[t._v("github")]),t._v("上的执行视图")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Master-Frank/Image-hosting/img/20211107093918.png",alt:"image-20211107093918647"}})]),t._v(" "),s("p",[t._v("此时打开"),s("code",[t._v("gitee")]),t._v("，就会发现自动创建了同名称的仓库且自动提交了同样的代码")]),t._v(" "),s("p",[t._v("分析"),s("code",[t._v("action")]),t._v("的执行日志，主要如下")]),t._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\nSuccessfully installed GitPython-3.1.13 PyYAML-5.4.1 certifi-2021.5.30 chardet-4.0.0 gitdb-4.0.7 idna-2.10 requests-2.25.1 six-1.16.0 smmap-4.0.0 tenacity-6.3.1 urllib3-1.26.6\n+ python3 /hub-mirror/hubmirror.py "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--src")]),t._v(" github/Hargeek "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--dst")]),t._v(" gitee/ssxr --dst-token *** --account-type user --clone-style https --cache-path /github/workspace/hub-mirror-cache --black-list "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v(" --white-list "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v(" --static-list python-nianbao-struct --force-update "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--debug")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--timeout")]),t._v(" 600s\nBackup python-nianbao-struct\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("/3"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" Downloading"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\nStarting "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" clone https://github.com/Hargeek/python-nianbao-struct.git\nClone completed: /github/workspace/github/workspace/hub-mirror-cache/python-nianbao-struct\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("/3"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" Creating"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\npython-nianbao-struct doesn't exist, create it"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\nDestination repo creating accepted.\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("/3"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" Force pushing"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\nTotal: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(", skip: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(", successed: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(", failed: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(".\nFailed: "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n+ "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("exit")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\nCleaning up orphan processes\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br")])]),s("p",[t._v("大致流程：执行器运行起来后，自动检出了该仓库，然后判断目标仓库是否存在，不存在则先创建，存在则直接执行强制推送")]),t._v(" "),s("p",[t._v("后面每一次提交代码或对仓库做变更都可以按照触发条件触发"),s("code",[t._v("action")]),t._v("的执行了")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Master-Frank/Image-hosting/img/20211107094013.png",alt:"image-20211107094013133"}})]),t._v(" "),s("h2",{attrs:{id:"_7、小结"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_7、小结"}},[t._v("#")]),t._v(" 7、小结")]),t._v(" "),s("p",[t._v("到这里，利用"),s("code",[t._v("github action")]),t._v("将"),s("code",[t._v("github")]),t._v("仓库的代码实时同步到"),s("code",[t._v("gitee")]),t._v("就完成了，个人认为"),s("code",[t._v("github action")]),t._v("比"),s("code",[t._v("gitlab ci")]),t._v("更为强大且有更多高阶玩法，但企业内部一般还都是私有仓库，因此对个人来说还是很实用的。")])])}),[],!1,null,null,null);s.default=e.exports}}]);